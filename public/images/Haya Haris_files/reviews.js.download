!function(a){"use strict";if("undefined"==typeof ryviu&&(a.ryviu={}),a.ryviu={cdnjs:"cdn.ryviu.com",app_server:"https://app.ryviu.com",ajaxUrl:"https://app.ryviu.com/ajax.php",eCls:{total_widget:"",slider_widget:"ryviu-slider-reviews",show_reviews:"ryviu-show-reviews",colection:"ryviu-collection-widget"},version:"3.5",author:"ryviu.com",obj_scr:null,domain_shop_set:"",opt:"google",rocket:!1,sec_code:"",firebase:{},shop_domain:"",shop_url:"",protocol:document.location.protocol,user_id:0,data:{},wait_data:!0,libs_loaded:[],libs_need_load:{"mutation-summary":"https://app.ryviu.com/client/libraries/mutation-summary.js","lazy-image":"https://app.ryviu.com/client/libraries/angular-lazy-img.min.js","angular-animate":"https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular-animate.min.js",firebase:"https://www.gstatic.com/firebasejs/4.0.0/firebase.js","angularfire-min":"https://cdn.firebase.com/libs/angularfire/2.3.0/angularfire.min.js"},firebase_config:{apiKey:"AIzaSyBhFeLXeMBYLha3SPDq8IofWlwLHLI17nk",authDomain:"ryviu-app.firebaseapp.com",databaseURL:"https://ryviu-app.firebaseio.com",projectId:"ryviu-app",storageBucket:"ryviu-app.appspot.com",messagingSenderId:"375939147949"},disable_product_reviews:!1,_settings:{},_settings_default:{},app_init:{},_php_server_url:"",_client_server_url:"",is_reviews_page:!1,member_status:"active",has_settings:function(){return"undefined"!=typeof ryviu_user_settings&&(!this.isEmpty(ryviu_user_settings)&&(this.isEmpty(this._settings)&&(this._settings=ryviu_user_settings),!0))},isEmpty:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return JSON.stringify(a)===JSON.stringify({})},client_options:{},client_options_default:{},getCls:function(a,b){return void 0===b&&(b=!1),!0===b?document.getElementsByClassName(a)[0]:document.getElementsByClassName(a)},mutation:{collection_added:[],init:function(a){new MutationSummary({callback:a,queries:[{element:".ryviu-collection-widget"},{element:".ryviu-show-reviews"},{element:".ryviu-widget"},{element:'div[style="display: block;"]'}]})}},masonry:{option:{itemSelector:".item",isAnimated:!0,initLayout:!0,animationOptions:{duration:750,easing:"linear",queue:!1},transitionDuration:"0.4s",isResizable:!0,hiddenStyle:{opacity:0}},max_time_scan:3e3,current_time_scan:0,selector:".ryviu-main-masonry-wrapper",is_exists:function(){return ryviu.getCls("ryviu-main-masonry-wrapper").length>0},init:function(){ryviu.load_script("https://unpkg.com/masonry-layout@4.2.0/dist/masonry.pkgd.min.js",function(){})}},owl:{css:{"owl-carousel-min":"https://cdnjs.cloudflare.com/ajax/libs/owl-carousel/1.3.3/owl.carousel.min.css","owl-theme-min":"https://cdnjs.cloudflare.com/ajax/libs/owl-carousel/1.3.3/owl.theme.min.css","owl-transitions-min":"https://cdnjs.cloudflare.com/ajax/libs/owl-carousel/1.3.3/owl.transitions.min.css"},custom_css:function(a,b){var c;return c="/client/themes/"+b+"/css/owl-custom.css","google"===a?"https://"+firebase_config.authDomain+c:app_server+"/"+c},js:{"owl-carousel-min":"https://cdnjs.cloudflare.com/ajax/libs/owl-carousel/1.3.3/owl.carousel.min.js"},slider_exists:function(){return ryviu.getCls(ryviu.eCls.slider_widget).length>0},init:function(){angular.forEach(ryviu.owl.css,function(a,b){ryviu.tools.add_style(b,a)}),angular.forEach(ryviu.owl.js,function(a){ryviu.load_script(a,function(){})})}},noty:{css:{"ryviu-noty":"https://www.ryviu.com/app/client/css/noty.css","ryviu-animate":"https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css"},js:{"ryviu-nory":"https://cdn.rawgit.com/needim/noty/a6cccf80/lib/noty.min.js"},init:function(){Object.keys(ryviu.noty.css).forEach(function(a){ryviu.tools.add_style(a,ryviu.noty.css[a])}),Object.keys(ryviu.noty.js).forEach(function(a){ryviu.load_script(ryviu.noty.js[a],function(){})});var a=function(){setTimeout(function(){if("undefined"!=typeof Noty&&"undefined"!=typeof firebase){ryviu.firebase.database().ref("ryviu_client_settings").orderByChild("shop_url").equalTo(ryviu.shop_url).on("child_added",function(a){var b,c=a.key;"undefined"!=typeof Storage&&(b=localStorage.getItem("client_ip")),ryviu.firebase.database().ref("ryviu_client_noty").child(c).on("value",function(a){var c,d=a.val();try{if(void 0!==d.data&&(c=d.data,d.ip!==b))if("undefined"!=typeof Storage){var e=d.time,f=localStorage.getItem("noty_show_time");null!==e&&e.toString()!==f&&(ryviu.noty.show(ryviu.noty.message_theme(c,c.type)),localStorage.setItem("noty_show_time",e))}else ryviu.noty.show(ryviu.noty.message_theme(c,c.type))}catch(a){}})})}else a()},2e3)};setTimeout(function(){ryviu.has_settings()&&!0===ryviu._settings.notyRealtimeStatus&&a()},1e3)},message_theme:function(a,b){var c,d;return void 0===b&&(b="vote"),"vote"===b||"write-reply"==b?("vote"==b&&(d="voted"),"write-reply"==b&&(d="replied"),c='<div class="heading">Someone just <span>'+d+'</span> this review <a href="'+a.product_url+'">View Reviews</a></div>',c+='<div class="noty-body"><img src="'+a.img+'"><span class="r-a"><span class="star star_'+a.star+'"></span> Written by <span class="au">'+a.author+"</span> on "+a.creat_at+"</span><p>"+a.review_text+"</p></div>"):("send-question"==b&&(d="sent question"),"write-review"==b&&(d="reviewed"),c='<div class="heading"><span>'+a.author+"</span> just "+spe+' <span class="star star_'+a.star+'"></span> for <a href="'+a.product_url+'">This Product</a> </div>',c+='<div class="noty-body"><img src="'+a.img+'"><p>'+a.review_text+"</p></div>"),c},show:function(a,b,c){void 0===b&&(b="alert"),void 0===c&&(c=6e3);new Noty({text:a,type:b,theme:"relax",layout:"bottomLeft",animation:{open:"animated bounceInLeft",close:"animated bounceOutLeft"},timeout:c}).show()}},is_init:function(){if(this.getCls(this.eCls.colection).length>0||this.getCls(this.eCls.show_reviews).length>0)return!0;var a=document.getElementsByTagName("ryviu-show-all-reviews");return ryviu.is_reviews_page=!0,a.length>0},client_site:{shop_domain:function(){return"object"==typeof Shopify&&Shopify.shop?Shopify.shop:""!==ryviu.domain_shop_set?ryviu.domain_shop_set:document.domain},shop_url:function(){var a,b;return b=ryviu.client_site.shop_domain(),ryviu.shop_domain=b,a=ryviu.protocol+"//"+b,a=a.replace(/\/$/,"")},handle:function(){return ryviu.getCls(ryviu.eCls.show_reviews).length>0?ryviu.getCls(ryviu.eCls.show_reviews)[0].getAttribute("product-handle"):""},ajax:function(a,b,c,d){if("undefined"==typeof jQuery){var e=Object.keys(b).map(function(a){return encodeURIComponent(a)+"="+encodeURIComponent(b[a])}).join("&"),f=new XMLHttpRequest;f.onreadystatechange=function(){4===this.readyState&&200===this.status&&""!==this.responseText&&c(JSON.parse(this.responseText)),4===this.readyState&&200!==this.status&&d()},f.open("POST",ryviu.ajaxUrl+"?action="+a+"&"+e,!0),f.send()}else jQuery.ajax({method:"POST",url:ryviu.ajaxUrl+"?action="+a,data:b}).done(function(a){c(a)})},get_reviews_data:function(a,b){ryviu.client_site.ajax("find_reviews",{send:ryviu.data_send()},a,b)},request:function(a){if(ryviu.tools.isURL(a)){var b=new XMLHttpRequest;b.onreadystatechange=function(){},b.open("POST",a,!0),b.send()}},move_settings_to_theme:function(){var a,b;if(-1!==ryviu.shop_domain.indexOf("myshopify.com")){a=ryviu.app_server.replace("app","www")+"/shopify/ryviu-smart-settings.php?shop="+ryviu.shop_domain+"&protocol="+ryviu.protocol,ryviu.client_site.request(a)}else if("undefined"!=typeof ryviu_flatform)switch(ryviu_flatform){case"woocommerce":b=ryviu.tools.base64.encode(JSON.stringify(ryviu.data.client_settings)),a=ryviu.shop_url+"/wp-content/plugins/ryviu/ajax.php?action=updateSettings&data="+b,ryviu.client_site.request(a);break;default:console.log(ryviu_flatform)}}},init:function(){if(String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a,"g"),b)},this.set_controller(),this.add_scripts(),this.rocket){var a={"masonry-min":"https://unpkg.com/masonry-layout@4.2.0/dist/masonry.pkgd.min.js"};this.libs_need_load=this.rv_merge_objs(this.libs_need_load,a)}this.shop_url=this.client_site.shop_url();var b=function(){"undefined"==typeof jQuery&&ryviu.load_script("https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js",function(){}),"undefined"==typeof angular?ryviu.load_script("https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js",function(){ryviu.load_more_script()}):ryviu.load_more_script(),ryviu.run()};ryviu.is_init()&&!ryviu.tools.botCheck()&&this.client_site.get_reviews_data(function(a){var c;if(ryviu.disable_product_reviews=a.disable_product,ryviu.member_status=a.member_status,"active"===ryviu.member_status){ryviu.sec_code=a.security,c="clear",ryviu.data=a,!1===ryviu.data.rec&&ryviu.client_site.move_settings_to_theme();try{c=ryviu.data.client_settings.client_theme,void 0===c&&(c="clear")}catch(a){c="clear"}ryviu.is_reviews_page&&(c="masonry"),ryviu.tools.add_style("ryviu-style",ryviu.app_server+"/client/themes/"+c+"/css/style.css"),ryviu.data.client_settings=a.client_settings,ryviu.wait_data=!1,b()}},function(){ryviu.get_default_settings("https://"+ryviu.firebase_config.authDomain+"/client/default-settings.json",function(a){ryviu.wait_data=!1,b()})})},callback:{shop_product_handle:[],loadCollectionsData:function(a,b){angular.element(document.body).scope().collection_products_get_data(ryviu.shop_domain,ryviu.callback.shop_product_handle),a(b)}},tools:{botCheck:function(){var a="(googlebot/|Googlebot-Mobile|Googlebot-Image|Google favicon|Mediapartners-Google|bingbot|slurp|java|wget|curl|Commons-HttpClient|Python-urllib|libwww|httpunit|nutch|phpcrawl|msnbot|jyxobot|FAST-WebCrawler|FAST Enterprise Crawler|biglotron|teoma|convera|seekbot|gigablast|exabot|ngbot|ia_archiver|GingerCrawler|webmon |httrack|webcrawler|grub.org|UsineNouvelleCrawler|antibot|netresearchserver|speedy|fluffy|bibnum.bnf|findlink|msrbot|panscient|yacybot|AISearchBot|IOI|ips-agent|tagoobot|MJ12bot|dotbot|woriobot|yanga|buzzbot|mlbot|yandexbot|purebot|Linguee Bot|Voyager|CyberPatrol|voilabot|baiduspider|citeseerxbot|spbot|twengabot|postrank|turnitinbot|scribdbot|page2rss|sitebot|linkdex|Adidxbot|blekkobot|ezooms|dotbot|Mail.RU_Bot|discobot|heritrix|findthatfile|europarchive.org|NerdByNature.Bot|sistrix crawler|ahrefsbot|Aboundex|domaincrawler|wbsearchbot|summify|ccbot|edisterbot|seznambot|ec2linkfinder|gslfbot|aihitbot|intelium_bot|facebookexternalhit|yeti|RetrevoPageAnalyzer|lb-spider|sogou|lssbot|careerbot|wotbox|wocbot|ichiro|DuckDuckBot|lssrocketcrawler|drupact|webcompanycrawler|acoonbot|openindexspider|gnam gnam spider|web-archive-net.com.bot|backlinkcrawler|coccoc|integromedb|content crawler spider|toplistbot|seokicks-robot|it2media-domain-crawler|ip-web-crawler.com|siteexplorer.info|elisabot|proximic|changedetection|blexbot|arabot|WeSEE:Search|niki-bot|CrystalSemanticsBot|rogerbot|360Spider|psbot|InterfaxScanBot|Lipperhey SEO Service|CC Metadata Scaper|g00g1e.net|GrapeshotCrawler|urlappendbot|brainobot|fr-crawler|binlar|SimpleCrawler|Livelapbot|Twitterbot|cXensebot|smtbot|bnf.fr_bot|A6-Indexer|ADmantX|Facebot|Twitterbot|OrangeBot|memorybot|AdvBot|MegaIndex|SemanticScholarBot|ltx71|nerdybot|xovibot|BUbiNG|Qwantify|archive.org_bot|Applebot|TweetmemeBot|crawler4j|findxbot|SemrushBot|yoozBot|lipperhey|y!j-asr|Domain Re-Animator Bot|AddThis)",b=new RegExp(a,"i"),c=navigator.userAgent;return!!b.test(c)},getDateNow:function(){var a=new Date,b=a.getDate(),c=a.getMonth()+1;return a.getFullYear().toString().substr(2,2)+"-"+c+"-"+b+" "+a.getHours()+":"+a.getMinutes()},debounce:function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},_href:function(){return a.location.protocol+"//"+a.location.host+a.location.pathname},add_style:function(a,b){if(!document.getElementById(a)){var c=document.getElementsByTagName("head")[0],d=document.createElement("link");d.id=a,d.rel="stylesheet",d.type="text/css",d.href=b,d.media="all",c.appendChild(d)}},randIn:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},validateEmail:function(a){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)},isURL:function(a){var b=/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi;return new RegExp(b).test(a)},getByteLen:function(a){a=String(a);for(var b=0,c=0;c<a.length;c++){var d=a.charCodeAt(c);b+=d<128?1:d<2048?2:d<65536?3:d<1<<21?4:d<1<<26?5:d<1<<31?6:Number.NaN}return b},decode_css:function(a){var b="";a=a.replace(/\s+/g," ").replace(/\/\*[^\/\*]+\*\//g,"").replace(/[^a-zA-Z0-9\-\_\. \:\(\)\%\+\~\;\#\'\{\}\@\/]+/g,"").trim().split("{");for(var c in a)if(a[c].indexOf("}")>-1){a[c]=a[c].split("}"),a[c][0]=a[c][0].split(";");for(var d in a[c][0])""!==a[c][0][d].trim()&&(b+="   "+a[c][0][d]+";\n");""!==a[c][1].trim()?b+="}\n"+a[c][1]+"{\n":b+="}\n",void 0!==a[c][2]&&(b+="}\n")}else""!==a[c].trim()&&(b+=a[c]+"{\n");return b},encode_css:function(a){return void 0===a&&(a=""),a=a.replace(/\/\*[^\/\*]+\*\//g,"").replace(/\ \ /g,"").replace(/[^a-zA-Z0-9\-\_\. \:\(\)\%\+\~\;\!\#\'\{\}\@\/]+/g,"").trim()},rgb2hex:function(a){function b(a){return("0"+parseInt(a).toString(16)).slice(-2)}return-1===a.indexOf("rgb")?a:(a=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),"#"+b(a[1])+b(a[2])+b(a[3]))},hex2rgb:function(a){return r=a.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i),r?r.slice(1,4).map(function(a){return parseInt(a,16)}):(r=a.match(/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i),r?r.slice(1,4).map(function(a){return 17*parseInt(a,16)}):a)},base64:{codex:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){if(void 0===a)return"";for(var b=new this.stringBuffer,c=new this.utf8EncodeEnumerator(a);c.moveNext();){var d=c.current;c.moveNext();var e=c.current;c.moveNext();var f=c.current,g=d>>2,h=(3&d)<<4|e>>4,i=(15&e)<<2|f>>6,j=63&f;isNaN(e)?i=j=64:isNaN(f)&&(j=64),b.append(this.codex.charAt(g)+this.codex.charAt(h)+this.codex.charAt(i)+this.codex.charAt(j))}return b.toString()},decode:function(a){if(void 0===a)return"";for(var b=new this.stringBuffer,c=new this.decodeEnumerator(a);c.moveNext();){var d,e,f=c.current;f<128?b.append(String.fromCharCode(f)):f>191&&f<224?(c.moveNext(),d=c.current,b.append(String.fromCharCode((31&f)<<6|63&d))):(c.moveNext(),d=c.current,c.moveNext(),e=c.current,b.append(String.fromCharCode((15&f)<<12|(63&d)<<6|63&e)))}return b.toString()},stringBuffer:function(){this.buffer=[]},utf8EncodeEnumerator:function(a){this._input=a,this._index=-1,this._buffer=[]},decodeEnumerator:function(a){this._input=a,this._index=-1,this._buffer=[]}}},set_controller:function(){document.getElementsByTagName("html")[0].setAttribute("ng-controller","ryviuMainCtrl")},add_scripts:function(){var a=document.getElementsByTagName("script");Object.keys(a).forEach(function(b){var c=a[b],d=null,e=ryviu.cdnjs;if("object"==typeof c&&(d=c.getAttribute("src")),null!==d&&(d=d.toString(),-1!==d.indexOf(e))){ryviu.obj_scr=c;var f=ryviu.get_parameter_by_name("shop",d),g=ryviu.get_parameter_by_name("opt",d),h=ryviu.get_parameter_by_name("rocket",d);ryviu.domain_shop_set=f,ryviu.opt=g,ryviu.rocket=h}})},get_parameter_by_name:function(b,c){c||(c=a.location.href),b=b.replace(/[\[\]]/g,"\\$&");var d=new RegExp("[?&]"+b+"(=([^&#]*)|&|#|$)"),e=d.exec(c);return e?e[2]?decodeURIComponent(e[2].replace(/\+/g," ")):"":null},data_send:function(){var a,b,c,d;return b=this.client_site.shop_url(),c=this.client_site.handle(),d=this.has_settings(),a='{"shop_url":"'+b+'", "handle":"'+c+'", "has_settings":'+d+"}",a=ryviu.tools.base64.encode(a)},load_script:function(a,b){var c,d=ryviu.obj_scr;return c=document.createElement("script"),c.type="text/javascript",c.readyState?c.onreadystatechange=function(){return"loaded"===c.readyState||"complete"===c.readyState?(c.onreadystatechange=null,b()):void 0}:c.onload=function(){return b()},c.src=a,d.parentNode.insertBefore(c,d)},get_default_settings:function(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4===this.readyState&&200===this.status&&(ryviu.client_options_default=JSON.parse(this.responseText),void 0!==typeof b&&b(ryviu.client_options_default))},c.open("POST",a,!0),c.send()},rv_merge_objs:function(a,b){var c={};for(var d in a)c[d]=a[d],d in b&&"object"==typeof a[d]&&null!==d&&(c[d]=this.rv_merge_objs(a[d],b[d]));for(d in b)d in c||(c[d]=b[d]);return c},im_wait_max_time:3e3,im_wait_current_time:0,im_wait:function(a,b){setTimeout(function(){ryviu.im_wait_current_time+=10,ryviu.wait_data?ryviu.im_wait_current_time<ryviu.im_wait_max_time?ryviu.im_wait(a,b):void 0!==b&&b():void 0!==a&&a()},10)},load_more_script:function(){Object.keys(this.libs_need_load).forEach(function(b,c,d){var e=ryviu.libs_need_load[b];ryviu.load_script(e,function(){if(ryviu.libs_loaded.push(b),"firebase"===b)if(firebase.apps.length){var e=a.location.href,f=function(){setTimeout(function(){e===a.location.href?f():location.reload()},10)};f(),ryviu.firebase=firebase.initializeApp(ryviu_firebase_config,"ryviu")}else ryviu.firebase=firebase.initializeApp(ryviu.firebase_config);c===d.length-1&&ryviu.im_wait(function(){ryviu.client_options=ryviu.data.client_settings,"object"==typeof ryviu.client_options&&null!==ryviu.client_options.mc_server&&(ryviu.client_options.mc_server="ryviu"),"masonry"===ryviu.client_options.client_theme&&ryviu.masonry.init(),ryviu.owl.slider_exists()&&ryviu.tools.add_style("ryviu-owl-custom",ryviu.owl.custom_css(ryviu.client_options.mc_server,ryviu.client_options.client_theme))},function(){ryviu.user_id=0,ryviu.firebase.database().ref("ryviu_client_settings").orderByChild("shop_url").equalTo(ryviu.shop_url).on("child_added",function(a){var b=a.key;if(b=parseInt(b),ryviu.user_id=b,angular.isNumber(b)&&null===ryviu.opt)try{ryviu.firebase.database().ref("ryviu_client_settings/"+b).once("value").then(function(a){ryviu.client_options=a.child("settings").val(),"masonry"===ryviu.client_options.client_theme&&ryviu.masonry.init(),ryviu.owl.slider_exists()&&ryviu.tools.add_style("ryviu-owl-custom",ryviu.owl.custom_css(ryviu.client_options.mc_server,ryviu.client_options.client_theme))})}catch(a){console.log(a)}else{var c=new XMLHttpRequest;c.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var a=JSON.parse(this.responseText);ryviu.client_options=a.options,"masonry"===ryviu.client_options.client_theme&&ryviu.masonry.init(),ryviu.owl.slider_exists()&&ryviu.tools.add_style("ryviu-owl-custom",ryviu.owl.custom_css(ryviu.client_options.mc_server,ryviu.client_options.client_theme))}},c.open("POST",ryviu.ajaxUrl+"?action=get_client_settings&user_id="+ryviu.user_id,!0),c.send()}})})})}),ryviu.owl.slider_exists()&&ryviu.owl.init()},elements:{getNodeIndex:function(a){for(var b=0;a=a.previousSibling;)3===a.nodeType&&/^\s*$/.test(a.data)||b++;return b}},brain:{options:function(){return ryviu.rv_merge_objs(ryviu.client_options,ryviu.client_options_default)},mc_server:function(){var a="ryviu";return void 0!==ryviu.client_options.mc_server&&(a=ryviu.client_options.mc_server),a},client_theme:function(){var a=ryviu.client_options.client_theme?ryviu.client_options.client_theme:"clear";return ryviu.is_reviews_page&&(a="masonry"),a},server_url:function(){var a,b;return b=ryviu.brain.mc_server(),"google"===b?a="https://"+ryviu.firebase_config.authDomain:"ryviu"===b&&(a=ryviu.app_server),a},php_server_url:function(){return ryviu.app_server+"/"},theme_path:function(){return ryviu.brain.server_url()+"/client/themes/"+ryviu.brain.client_theme()},main:function(b,c,d,e,f,g,h,i,j,k,l,m){function n(){var a=ryviu.getCls("container-ryviu");h(function(){if(null!==a)for(var b=0;b<a.length;b++){var d=a[b].offsetWidth;0===d?n():c.resizeFunction()}},100)}function o(){c.collection_products_handle=[],h(function(){angular.forEach(ryviu.getCls(ryviu.eCls.colection),function(a,b){var d=angular.element(a).attr("product-handle");if(""===d){var e,f,h;if(angular.element(a).closest("a.ls-link").length>0){if(e=angular.element(a).closest("a.ls-link").attr("href"),f=/^(http[s]?:\/\/){0,1}(www\.){0,1}[a-zA-Z0-9\.\-]+\.[a-zA-Z]{2,5}[\.]{0,1}/,"string"==typeof e&&f.test(e)){e=e.substring(0,e.indexOf("?")),h=e.substr(e.lastIndexOf("/")+1),-1===c.collection_products_handle.indexOf(h)&&c.collection_products_handle.push(h),angular.element(a).attr("product-handle",h);var i=g("<div class='"+ryviu.eCls.colection+"' data='collection_product_reviews' product-handle='"+h+"'></div>")(c);0===ryviu.getCls("ryviu-widget").length&&angular.element(a).replaceWith(i)}}else angular.element(a).closest("a").length>0&&(e=angular.element(a).closest("a").attr("href"),-1!==e.indexOf("products")&&(h=substr(e,strrpos(e,"/")+1),h?angular.element(a).attr("product-handle",h):s<q&&o()));-1===c.collection_products_handle.indexOf(h)&&""!==h&&c.collection_products_handle.push(h)}else-1===c.collection_products_handle.indexOf(d)&&c.collection_products_handle.push(d)}),s<q&&c.collection_products_handle.length>0&&c.collection_products_get_data(ryviu.shop_domain,c.collection_products_handle),ryviu.callback.shop_product_handle=c.collection_products_handle,s+=r},r)}function p(a){for(var b=atob(a.split(",")[1]),c=a.split(",")[0].split(":")[1].split(";")[0],d=[],e=0;e<b.length;e++)d.push(b.charCodeAt(e));return new Blob([new Uint8Array(d)],{type:c})}c.is_loading=!1,c.loader={show:!1,loading:!1,message:""},ryviu.client_options=ryviu.brain.options(),c.shop_domain=ryviu.shop_domain,c.f=function(a){return angular.element(document.querySelector(a))},c.hasClassess=function(a,b){for(var c=0;c<b.length;c++)if(angular.element(a).hasClass(b[c]))return!0;return!1},c.read_css_file=function(a){var b=new XMLHttpRequest,c="";return b.open("GET",a,!1),b.onreadystatechange=function(){4===b.readyState&&(200!==b.status&&0!==b.status||(c=b.responseText))},b.send(null),c},c.ren_custom_css=function(a){var b=a;return a.replaceAll(/{{(\w+.\w+)}}/,function(a,c,d,e){var f,g,h=c.split("|");if(h.length>1?(f=h[0],g=h[1],null!==g.match(/^[a-f0-9]{6}$/i)&&(g="#"+g)):f=h[0],-1!==f.indexOf(".")){var i=f.split("."),j=ryviu.client_options[i[0]];"object"==typeof j&&(f=void 0!==g&&""===j[i[1]]?g:j[i[1]])}else f=void 0!==g&&""===ryviu.client_options[f]?g:ryviu.client_options[f];b=b.replace(a,f)}),b},jQuery(".load_more").on("click",function(a){a.preventDefault(),c.checkHandleAjax()}),c.openFitlerStatus=!1,c.openFitler=function(){c.openRateListStatus=!1,!0===c.openFitlerStatus?c.openFitlerStatus=!1:c.openFitlerStatus=!0},c.openRateListStatus=!1,c.openRateList=function(){c.openFitlerStatus=!1,!0===c.openRateListStatus?c.openRateListStatus=!1:c.openRateListStatus=!0},c.checkHide=function(a){var b=angular.element(a.target)[0].className;"ryviu-lightbox"!==b&&"ryviu-image-popup"!==b||(c.gallery="")},c.f("body").append('<div class="ryviu-lightbox-ft"></div>'),c.f("body").append('<div class="ryviu-question-ft"></div>'),c.f("body").append('<div class="ryviu-answers-ft"></div>'),c.f("body").append('<div class="ryviu-form-ft"></div>'),c.f("body").append('<div class="ryviu-reply-ft"></div>'),c.resizeFunction=function(){var a=ryviu.getCls("container-ryviu");if(null!==a)for(var b=0;b<a.length;b++){var c=a[b].offsetWidth;c>=1300&&(a[b].classList.add("x-larger"),a[b].classList.remove("larger"),a[b].classList.remove("mobile"),a[b].classList.remove("small")),c<1300&&c>1120&&(a[b].classList.add("larger"),a[b].classList.add("x-larger"),a[b].classList.remove("mobile"),a[b].classList.remove("small")),c<=1120&&c>=769&&(a[b].classList.remove("x-larger"),a[b].classList.remove("larger"),a[b].classList.remove("mobile"),a[b].classList.remove("small")),c<769&&c>480&&(a[b].classList.remove("x-larger"),a[b].classList.remove("larger"),a[b].classList.add("mobile"),a[b].classList.remove("small")),c<=480&&(a[b].classList.remove("x-larger"),a[b].classList.remove("larger"),a[b].classList.add("mobile"),a[b].classList.add("small"))}},a.addEventListener("resize",c.resizeFunction),angular.element("a").on("click",function(){var a=this.getAttribute("href");null!==a&&-1!==a.indexOf("#")&&(n(),"masonry"===ryviu.brain.client_theme()&&c.$watch(function(){return angular.element(ryviu.masonry.selector).is(":visible")},function(){angular.element(ryviu.masonry.selector).masonry(ryviu.masonry.option)}))}),c.checkHandleAjax=function(){o()},c.voted=1,c.global_settings={php_server_url:ryviu._php_server_url,client_server_url:ryviu._client_server_url};var q=6e3,r=500,s=0;o();var t=Date.now(),u=function(a){if(a[0].added.length>0){c.collection_products_handle;angular.forEach(a[0].added,function(a,b){var d=angular.element(a),e=d.attr("product-handle");if(""!==e&&void 0!==e){var f=g("<div class='"+ryviu.eCls.colection+"' data='collection_product_reviews' product-handle='"+e+"'></div>")(c);d.replaceWith(f),-1===c.collection_products_handle.indexOf(e)&&c.collection_products_handle.push(e)}}),ryviu.callback.shop_product_handle=c.collection_products_handle,Date.now()-t>=3e3&&(c.collection_products_get_data(ryviu.shop_domain,c.collection_products_handle),t=Date.now())}a[1].added.length>0&&0===a[1].removed.length||a[2].added.length>0&&a[2].removed.length,a[3].added.length>0&&c.resizeFunction()};ryviu.mutation.init(u),c.client_settings={shop_url:ryviu.shop_url,theme:ryviu.brain.client_theme()},c.request={rating:1},c.masonry_limit=c.number_load_more=20,c.start=0,c.pageSize=5,c.limit=5,c.current=1,ryviu.client_options.reviews_per_page&&(c.masonry_limit=c.number_load_more=parseInt(ryviu.client_options.reviews_per_page)),c.star="*",c.maxPage=1,c.client_filter={reviews_per_page:"",order_by:""},c.masonry_load_more_text="Load More",ryviu.client_options.load_more_text&&(c.masonry_load_more_text=ryviu.client_options.load_more_text),c.masonry_load_more_reviews=function(){var a=c.masonry_limit+c.number_load_more;c.masonry_limit=a>c.product_reviews_list.length?c.product_reviews_list.length:a,c.reviews_load_left=c.product_reviews_list.length-c.masonry_limit,c.masonry_load_more_text="Loading...",ryviu.client_options.loading_text&&(c.masonry_load_more_text=ryviu.client_options.loading_text),"masonry"===ryviu.brain.client_theme()&&c.scan_images_in_masonry()},c.set_reviews_per_page=function(){""===c.client_filter.reviews_per_page?(c.limit=5,c.pageSize=5):(c.limit=c.client_filter.reviews_per_page,c.pageSize=c.client_filter.reviews_per_page),b.paging(c.totalForPaging)},c.rv_order="-created_at",c.set_reviews_order=function(a){switch(""===c.client_filter.order_by?c.reviews_order="late":c.reviews_order=c.client_filter.order_by=a,c.reviews_order){case"late":c.rv_order="-created_at";break;case"old":c.rv_order="created_at";break;case"star_desc":c.rv_order="-rating";break;case"star_asc":c.rv_order="rating"}c.showUlselect=!1,"masonry"===ryviu.brain.client_theme()&&c.reinit_masonry()},b.paging=function(a){c.paging=[];var b=Math.ceil(a/c.pageSize);c.maxPage=b,c.totalForPaging=a;for(var d=0;d<b;d++)c.paging[d]=d+1,c.paggingF(c.current)},c.changePager=function(){b.paging(c.product_reviews.length),c.limit=c.pageSize},c.paggingF=function(a){c.current=a,c.pageSize<c.product_reviews.length?c.start=c.pageSize*a-c.pageSize:c.start=0},c.next_page=function(){c.current<c.maxPage&&(c.current=c.current+1,c.paggingF(c.current))},c.back_page=function(){c.current>1&&(c.current=c.current-1,c.paggingF(c.current))},c.startsWithFilter=function(a){var b=new RegExp(c.filterLetter,"i");return a.name.substring(0,1).match(b)},c.loadRyviu=!1,c.client_settings=ryviu.brain.options(),c.get_reviews_firebase_data=function(a){var d=ryviu.firebase.database().ref("ryviu_reviews_data").child(ryviu.user_id+"/"+a),e=server_url+"/client/themes/"+ryviu.brain.client_theme()+"/css/custom.css",g=c.read_css_file(e),h=c.ren_custom_css(g);d.once("value").then(function(a){var d,e,g,i,j,k,l,m=a.child("data").val(),n=[],o={},p={};e=g=i=j=k=l=0,angular.forEach(m,function(a,b){if("object"==typeof a&&void 0===a.disable){var c,d,f,h,m,o,p,q=a,r=q.body,s=[];switch(f=void 0!==a.country_code?a.country_code:"object"==typeof a.client_info?a.client_info.country_code:"Unknown",q.country_name=f,q.country_code=f.toLowerCase(),d="20"+q.created_at,d=new Date(d),d=d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate(),c="20"+q.created_at.replace(" ","T")+":00",q.date_order=d,q.created_at=c,void 0===q.rating&&(q.rating=5),void 0!==q.avatar&&""!==q.avatar||(q.text_avatar=q.author.charAt(0)),void 0===q.body_text?(h=r.split("@"),q.body_text=h[0],void 0!==h[1]&&""!==h[1]&&(m=h[1],o=m.replaceAll("{","").replaceAll("}",""),p=o.split(";"),p.length>0&&angular.forEach(p,function(a){""!==a&&s.push(a)}),q.body_urls=s)):"@{"===q.body_text.substring(1,2)&&(h=r.split("@"),q.body_text=q.body="",void 0!==h[1]&&""!==h[1]&&(m=h[1],o=m.replaceAll("{","").replaceAll("}",""),p=o.split(";"),p.length>0&&angular.forEach(p,function(a){""!==a&&s.push(a)}),q.body_urls=s)),q.key=b,n.push(q),e+=parseInt(q.rating),parseInt(q.rating)){case 1:g++;break;case 2:i++;break;case 3:j++;break;case 4:k++;break;case 5:l++}}}),d=n.length>0?e/n.length:0,d=Math.round(100*d)/100,o.avg=d,o.star1=g,o.star2=i,o.star3=j,o.star4=k,o.star5=l,p={reviews:n,ratings:o},c.product_reviews=p.reviews,c.custom_css=ryviu.tools.encode_css(h),c.client_settings=ryviu.client_options;var q='<style type="text/css">'+c.custom_css+"</style>";switch(c.f("head").append(q),c.ratings=p.ratings,c.total=c.totalReviews=c.product_reviews.length,0===c.total&&(c.totalText="",c.client_settings.disableWidget=!0),c.client_filter.reviews_per_page=c.limit=c.pageSize=c.client_settings.reviews_per_page,c.client_filter.order_by=c.rv_order=c.client_settings.order_by,angular.forEach(c.client_settings,function(a,b){c.client_settings[b]||"boolean"==typeof c.client_settings[b]||(c.client_settings[b]=ryviu.client_options_default[b])}),c.client_filter.order_by){case"late":c.rv_order="-created_at";break;case"old":c.rv_order="created_at";break;case"star_desc":c.rv_order="-rating";break;case"star_asc":c.rv_order="rating"}c.product_reviews_list=c.product_reviews,c.totalNreviews=c.product_reviews.length,c.loadRyviu=!0,b.paging(c.product_reviews.length),c.rv_star_filter=function(a,d){c.star=c.star_number=a,c.current=1,c.start=1,c.totalReviews=d,c.product_reviews_list=f(c.product_reviews,{rating:a},!1),c.totalForPaging=c.product_reviews_list.length,b.paging(c.totalForPaging),c.number_load_more=20,c.client_settings.reviews_per_page&&(c.number_load_more=parseInt(c.client_settings.reviews_per_page)),"masonry"===ryviu.brain.client_theme()&&(c.reinit_masonry(),c.masonry_limit=c.number_load_more,c.masonry_limit>=c.product_reviews_list.length&&(c.masonry_limit=c.product_reviews_list.length),c.reviews_load_left=c.product_reviews_list.length-c.masonry_limit)},c.showAll=function(){c.start=0,c.limit=c.pageSize=c.totalForPaging=c.product_reviews.length,c.product_reviews_list=c.product_reviews},c.reviews_load_left=c.product_reviews_list.length-c.masonry_limit,c.reviews_load_left<0&&(c.reviews_load_left=0),c.$apply()})},c.emailLogin=!1,c.checkVerifyEmail=function(a){c.client_settings.RSA.enableVerifyEmail?c.verifyEmail?c.verifyEmail=!1:c.verifyEmail=!0:c.emailLogin=!0},c.do_has_data_reviews=function(d){c.loadRyviu=!0,c.client_settings.form={},c.client_settings={},c.product_reviews=d.reviews,c.custom_css=d.custom_css,c.customer_sent={type:"",status:!1},d.client_settings&&(c.client_settings=ryviu.rv_merge_objs(d.client_settings,ryviu.brain.options)),angular.forEach(c.client_settings,function(a,b){c.client_settings[b]||"boolean"==typeof c.client_settings[b]||(c.client_settings[b]=ryviu.client_options_default[b])});var e='<style type="text/css">'+c.custom_css+"</style>";if(c.f("head").append(e),c.ratings=d.ratings,c.total=c.totalReviews=c.product_reviews.length,0===c.ratings.count)c.totalText="",c.client_settings.disableWidget=!0;else{var g=c.client_settings;angular.forEach(g,function(a,b){void 0===g[b]&&(g[b]="")}),c.client_settings=g;var h=c.client_settings.reviewText,i=c.client_settings.reviewsText;parseInt(c.ratings.count)>0?c.totalText="("+c.ratings.count+" "+i+")":c.totalText="("+c.ratings.count+" "+h+")"}switch(c.client_filter.reviews_per_page=c.limit=c.pageSize=c.client_settings.reviews_per_page,c.client_filter.order_by=c.rv_order=c.client_settings.order_by,c.client_filter.order_by){case"late":c.rv_order="-created_at";break;case"old":c.rv_order="created_at";break;case"star_desc":c.rv_order="-rating";break;case"star_asc":c.rv_order="rating"}c.product_reviews_list=c.product_reviews,c.totalNreviews=c.product_reviews.length,b.paging(c.product_reviews.length),c.rv_star_filter=function(a,d){"theme_default"!=c.client_settings.client_theme||c.client_settings.disable_scroll||(document.getElementById("ryviu-header").classList.remove("r-fixed"),document.getElementById("ryviu-header").classList.remove("r-absolute")),c.star=a,c.star_number=a.toString(),c.current=1,c.start=1,"only_images"==a?(c.only_images_filter=1,c.product_reviews_list=f(c.product_reviews,{body_image:1},!1)):(c.only_images_filter=void 0,c.product_reviews_list=f(c.product_reviews,{rating:a},!1)),c.totalForPaging=c.product_reviews_list.length,b.paging(c.totalForPaging),c.number_load_more=20,c.client_settings.reviews_per_page&&(c.number_load_more=parseInt(c.client_settings.reviews_per_page)),"masonry"===ryviu.brain.client_theme()&&(c.scan_images_in_masonry(),c.masonry_limit=c.number_load_more,c.masonry_limit>=c.product_reviews_list.length&&(c.masonry_limit=c.product_reviews_list.length),c.reviews_load_left=c.product_reviews_list.length-c.masonry_limit)},"theme_default"!=c.client_settings.client_theme||c.client_settings.disable_scroll||a.addEventListener("scroll",function(a){if(c.product_reviews_list.length>0){var b=document.getElementById("ryviu-check-scroll"),d=document.getElementById("ryviu-header"),e=b.getBoundingClientRect().top,f=b.getBoundingClientRect().bottom,g=(d.getBoundingClientRect().top,document.getElementById("ryviu-header").offsetHeight);b.style.minHeight=g+"px",e<=0?(document.getElementById("ryviu-header").classList.add("r-fixed"),f<=0?document.getElementById("ryviu-header").classList.add("r-absolute"):Math.abs(f)<=g?document.getElementById("ryviu-header").classList.add("r-absolute"):document.getElementById("ryviu-header").classList.remove("r-absolute")):document.getElementById("ryviu-header").classList.remove("r-fixed")}}),c.r_limit=c.number_load_more=10,ryviu.client_options.reviews_per_page&&(c.r_limit=c.number_load_more=parseInt(ryviu.client_options.reviews_per_page)),c.r_loadmore=function(){var a=parseInt(c.limit)+parseInt(c.number_load_more);c.limit=a>c.product_reviews_list.length?c.product_reviews_list.length:a},c.showAll=function(){c.start=0,c.limit=c.pageSize=c.totalForPaging=c.product_reviews.length,c.product_reviews_list=c.product_reviews},c.masonry_limit>=c.product_reviews_list.length&&(c.masonry_limit=c.product_reviews_list.length),c.reviews_load_left=c.product_reviews_list.length-c.masonry_limit,c.reviews_load_left<0&&(c.reviews_load_left=0)},c.first_load_reviews=function(a){c.product_handle=a,"google"===ryviu.brain.mc_server()?c.get_reviews_firebase_data(a):"ryviu"===ryviu.brain.mc_server()&&c.do_has_data_reviews(ryviu.data)},c.load_reviews=function(a){c.product_handle=a,"google"===ryviu.brain.mc_server()?c.get_reviews_firebase_data(a):"ryviu"===ryviu.brain.mc_server()&&d({url:ryviu.ajaxUrl,method:"POST",data:{shop_url:ryviu.shop_domain,handle:a,protocol:ryviu.protocol},params:{action:"client_get_reviews"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){c.do_has_data_reviews(a.data)},function(a){console.log(a)})},c.collection_products_get_data=function(a,b){"ryviu"===ryviu.brain.mc_server()&&b.length>0?d({url:ryviu.ajaxUrl,method:"POST",data:{shop_url:a,products_handle:b,protocol:ryviu.protocol},params:{action:"collection_products_get_data"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){"object"==typeof a.data&&(c.collection_product_reviews=a.data)},function(a){console.log(a)}):console.log("No product handle.")},c.show_pop_img=function(a,b,d,e,f,h,i,j,k,l,m,n,o,p){c.gallery=a,c.imgDefault=b,c.imgAvatar=d,c.titleAvatar=e,c.hideAvatar=f,c.imgName=h,c.hidename=i,c.ratingstar=j,c.imgDate=k,c.imgdateFomart=l,c.hidedate=m,c.imgTitle=n,c.hidetitle=o,c.imgContent=p;var q=g('<div ng-click="checkHide($event)" ng-if="gallery" id="ryviuPopImg" class="ryviu-lightbox animate-if" data="gallery" data-default="imgDefault" data-avatar="imgAvatar" data-tavatar="titleAvatar" data-hideavatar="hideAvatar" data-name="imgName" data-hidename="hidename" data-ratingstar="ratingstar" data-date="imgDate" data-format="imgdateFomart" data-hidedate="hidedate" data-title="imgTitle" data-hidetitle="hidetitle" data-content="imgContent" data-hide="hideLightbox"></div>')(c);c.f(".ryviu-lightbox-ft").replaceWith(q)},c.hideLightbox=function(){c.gallery=""},c.show_write_review=function(a){c.verifyEmail=c.ryviuSuccess=!1,c.customer_sent.type="review",c.client_settings.RSA.enableVerifyEmail||c.client_settings.RSA.enableSocialAuth?c.verifyEmail=!1:c.emailLogin=!0,c.formWriteReview="true";var b=g('<div class="ryviu-form-write-review form-write-review animate-if" ng-if="formWriteReview"></div>')(c);c.f(".ryviu-form-ft").replaceWith(b)},c.hide_write_review=function(a){c.formWriteReview="",c.customer_sent.status||"review"!==c.customer_sent.type||(console.log("Cancel Write Review"),c.list_media_upload.length>0&&d.post(ryviu.ajaxUrl+"?action=remove_temporary_images",{shop_url:ryviu.shop_domain,handle:c.product_handle,protocol:ryviu.protocol,media:c.list_media_upload,img_urls:c.img_urls},{"Content-Type":"application/x-www-form-urlencoded"}).then(function(a){console.log("Remove temporary images"),c.list_media_upload=[],c.img_urls=[]}),c.customer_sent={type:"",status:!1})},c.anonymous_vote=function(a,b,e){c.likeStatus=a,d({url:ryviu.ajaxUrl,method:"POST",data:{shop_url:ryviu.shop_domain,handle:c.product_handle,review_key:b,type:a,protocol:ryviu.protocol},params:{action:"anonymous_vote"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){var d=[];angular.forEach(c.product_reviews_list,function(c){c.key===b?angular.forEach(a.data.new_reviews_data,function(a){a.key===b&&d.push(a)}):d.push(c)}),c.product_reviews_list=d,c.product_reviews=a.data.new_reviews_data},function(a){console.log(a)})},c.feature_anonymous_vote=function(a,b,e){c.likeStatus=a,d({url:ryviu.ajaxUrl,method:"POST",data:{shop_url:ryviu.shop_domain,handle:c.product_handle,feature_id:b,type:a,protocol:ryviu.protocol},params:{action:"feature_anonymous_vote"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){!1===a.data.error&&(e.like=a.data.like_arr)},function(a){console.log(a)})},c.openReplyForm=function(a,b,d,e,f,h,i,j,k){c.formWriteReply="true",c.current_review_key=a,c.ravatar=b,c.rrating=d,c.rtitle=e,c.rbody=f,c.rauthor=h,c.rimages=i,c.rlike=j,c.rshortname=k,c.reply_request={reply_cname:"",reply_cemail:"",reply_ccontent:""};var l=g('<div class="ryviu-form-write-review form-reply-review animate-if" ng-if="formWriteReply"></div>')(c);c.f(".ryviu-reply-ft").replaceWith(l)},c.hideReplyForm=function(){c.formWriteReply="",c.current_review_key=""},c.validateEmail=function(a){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)},c.img_urls=[],c.list_media_upload=[],c.uploadImage=function(a){c.uploadfile=a;var b=angular.element('input[name="uploadfile"]'),e=b[0].files[0].name;if(void 0!==c.uploadfile){var f=new FormData,h=p(c.uploadfile);f.append("file",h,e),d.post(ryviu.ajaxUrl+"?action=upload_images_reviews&shop_url="+ryviu.shop_domain+"&handle="+c.product_handle+"&protocol="+ryviu.protocol,f,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).then(function(a){if("object"==typeof a){var b=angular.element(document.querySelector("#ryviu_images_uploaded")),d='<span class="img"><img src="'+a.data.img+'" width="100" /><a class="close" ng-click="remove_img($event,\''+a.data.img+"')\">✖</a></span>";angular.element(b).append(g(d)(c)),c.img_urls.push(a.data.img),c.list_media_upload.push(a.data.media_id)}},function(a){console.log(a)})}},c.uploadTrigger=function(){c.f(".ryviu-upload")[0].click()},c.fileChanged=function(a){console.log($event.target.files)},c.remove_img=function(a,b){d({url:ryviu.ajaxUrl,method:"POST",data:{shop_url:ryviu.shop_domain,handle:c.product_handle,img_url:b,protocol:ryviu.protocol},params:{action:"client_remove_image"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(b){!0===b.data.status&&a.target.parentNode.remove()},function(a){console.log(a)})},c.get_img_ext=function(a){return a.split(".").pop()},c.__img=function(a){var b,d=a;if(b=c.get_img_ext(a),a.indexOf("//cdn-img.ryviu.com")>0)d=a.replace("."+b,"")+"_250x250."+b;else if(a.indexOf("//img.ryviu.com")>0){var e=ryviu.tools.base64.decode(a.substr(a.lastIndexOf("/")+1)),f=c.get_img_ext(e);e=e+"_50x50."+f,d="https://img.ryviu.com/"+ryviu.tools.base64.encode(e)}else d=a+"_50x50."+b;return d},c.sendReview=function(a){c.is_loading=!0,d({url:ryviu.ajaxUrl,method:"POST",data:angular.extend({shop_url:ryviu.shop_domain,handle:c.product_handle,protocol:ryviu.protocol,ip:c.ip},a),params:{action:"client_send_review"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){"object"==typeof a.data&&(!0===c.is_user_logged_in?(c.request={rating:5,cname:c.request.cname,cemail:c.request.cemail,ctitle:null,ccontent:null,img_urls:[]},c.resend_request=c.request):c.request={rating:5,cname:null,cemail:null,ctitle:null,ccontent:null,img_urls:[]},c.img_urls=[],c.product_reviews_list=a.data.new_reviews_data,c.ratings=a.data.ratings,c.total=c.product_reviews_list.length,c.totalNreviews=c.product_reviews_list.length,c.ryviuSuccess=!0,c.customer_sent.status=!0,"masonry"===ryviu.brain.client_theme()&&(c.reinit_masonry(),c.resizeFunction()),h(function(){c.hide_write_review(),c.ryviuSuccess=!1},5e3)),c.is_loading=!1},function(a){console.log(a)})},ryviu.firebase.auth().onAuthStateChanged(function(a){a?(c.is_user_logged_in=!0,c.user_info=a,c.user_info=a.providerData[0],c.$apply()):(c.user_info={},c.is_user_logged_in=!1,c.request.avatar="")}),void 0===c.is_user_logged_in&&(c.is_user_logged_in=!1),c.verify_email_sent=!1,c.verify_client_email=function(a){if(!1===c.verify_email_sent){var b=ryviu.app_init.security_code;d({url:ryviu.ajaxUrl,method:"POST",data:angular.extend({shop_url:ryviu.shop_domain,handle:c.product_handle,protocol:ryviu.protocol},{email:a,security:b}),params:{action:"verify_client_email"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){if("object"==typeof a.data){c.verify_email_sent=!0;var d=ryviu.getCls("email_verify"),e=ryviu.firebase.database().ref("ryviu_auth_verify").child(a.data.vid);d[0].innerHTML="Sent",c.verify_data=k(e),e.on("value",function(d){var e=d.val();if(b===e.security_code&&""!==e.p_code){var f=a.data.email,g=e.p_code;ryviu.firebase.auth().signInWithEmailAndPassword(f,g).catch(function(a){""===a?(c.is_user_logged_in=!0,c.request.cemail=f,c.$apply()):"auth/user-not-found"===a.code?ryviu.firebase.auth().createUserWithEmailAndPassword(f,g).catch(function(a){console.log(a),c.is_user_logged_in=!0,c.request.cemail=f,c.$apply()}):"auth/wrong-password"===a.code?ryviu.client_site.ajax("sendUserAuthPass",{email:f,password:g},function(a){"sent"===a.status&&ryviu.firebase.auth().sendPasswordResetEmail(f).then(function(){console.log("sent reset email")}).catch(function(a){console.log(a)})},function(){}):console.log(a)})}})}},function(a){console.log(a)})}else alert("Check your email box and click verify link.")},c.auth_facebook_login=function(){var a=new firebase.auth.FacebookAuthProvider;a.addScope("email"),ryviu.firebase.auth().signInWithPopup(a).then(function(a){var b=a.user;c.social_login_error=!1,c.is_user_logged_in=!0,c.user_info=b,c.$apply()}).catch(function(a){v(a)})},c.auth_twitter_login=function(){var a=new firebase.auth.TwitterAuthProvider;ryviu.firebase.auth().signInWithPopup(a).then(function(a){var b=(a.credential.secret,a.user);c.social_login_error=!1,c.is_user_logged_in=!0,c.user_info=b,c.$apply()}).catch(function(a){v(a)})},c.auth_google_login=function(){var a=new firebase.auth.GoogleAuthProvider;ryviu.firebase.auth().signInWithPopup(a).then(function(a){var b=a.user;c.social_login_error=!1,c.is_user_logged_in=!0,c.user_info=b,c.$apply()}).catch(function(a){v(a)})};var v=function(a){console.log(a),a.email&&(c.request.cemail=a.email),c.social_login_error=!0,c.social_login_message=a.message,c.$apply()};c.user_auth_logout=function(){c.social_login_error=!1,c.is_user_logged_in=!1,c.verify_email_sent=!1,c.request.cemail="",c.request.cname="",ryviu.firebase.auth().signOut()},void 0!==c.client_settings.RSA.enableSocialAuth&&void 0!==c.client_settings.RSA.enableVerifyEmail&&(c.client_settings.RSA.enableSocialAuth||c.client_settings.RSA.enableVerifyEmail||c.user_auth_logout()),d.get("https://api.ipify.org/?format=json").then(function(a){200===a.status&&(c.ip=a.data.ip,"undefined"!=typeof Storage&&localStorage.setItem("client_ip",a.data.ip))}),c.openQuestionForm=function(){c.show_questions_form=!0;var a=g('<div class="ryviu-form-write-review form-send-question animate-if" ng-if="show_questions_form"></div>')(c,function(a,b){});c.f(".ryviu-question-ft").replaceWith(a),angular.element("body")[0].style.overflow="hidden"},c.openAnswersForm=function(a,b){c.show_answers_form=!0,c.current_question=a,c.qa_show_type=b;var d=g('<div class="ryviu-form-write-review form-answers-question animate-if" ng-if="show_answers_form"></div>')(c,function(a,b){});c.f(".ryviu-answers-ft").replaceWith(d),angular.element("body")[0].style.overflow="hidden"},c.hideQuestionForm=function(){c.show_questions_form="",angular.element("body")[0].style.overflow="scroll"},c.hideAnswerForm=function(){c.show_answers_form="",angular.element("body")[0].style.overflow="scroll"},c.highlight=function(a,b){return b?e.trustAsHtml(a.replace(new RegExp(b,"gi"),'<span class="highlightedText">$&</span>')):e.trustAsHtml(a)},c.init_masonry=function(a,b){a&&c.scan_images_in_masonry()},c.masonry_images_loaded=[],c.masonry_show=!1,c.scan_images_in_masonry=function(){var a=l.find(ryviu.masonry.selector),b=a.find(".msr-img"),d=[];h(function(){angular.forEach(b,function(a,b){a.src&&(-1===d.indexOf(a)&&d.push(a),angular.element(a).bind("load",function(){-1===c.masonry_images_loaded.indexOf(a)&&c.masonry_images_loaded.push(a)}))}),c.masonry_images_loaded.length<d.length?(ryviu.masonry.current_time_scan+=100,ryviu.masonry.current_time_scan<ryviu.masonry.max_time_scan?c.scan_images_in_masonry():h(function(){c.masonry_show=!0,c.masonry_load_more_text="Load More",ryviu.client_options.load_more_text&&(c.masonry_load_more_text=ryviu.client_options.load_more_text),angular.element(ryviu.masonry.selector).masonry(ryviu.masonry.option).masonry("reloadItems"),ryviu.masonry.current_time_scan=0})):h(function(){c.masonry_show=!0,c.masonry_load_more_text="Load More",ryviu.client_options.load_more_text&&(c.masonry_load_more_text=ryviu.client_options.load_more_text),angular.element(ryviu.masonry.selector).masonry(ryviu.masonry.option).masonry("reloadItems"),ryviu.masonry.current_time_scan=0})},100)},c.reinit_masonry=function(){h(function(){angular.element(ryviu.masonry.selector).masonry(ryviu.masonry.option).masonry("reloadItems"),ryviu.masonry.current_time_scan=0},1e3)}},directive:{masonryFirstImage:function(){return{restrict:"C",scope:{imgsize:"=imgsize"},link:function(a,b,c){if(void 0!==a.imgsize){console.log(a.imgsize),console.log(b);var d,e=a.imgsize[0],f=a.imgsize[1],g=b[0].clientWidth;d=g*f/e,b.css({width:d+"px",height:g+"px"})}}}},lightbox:function(b){return{templateUrl:ryviu.app_init.html_file.lightbox,scope:{gallery:"=data",imgDefault:"=default",imgAvatar:"=avatar",titleAvatar:"=tavatar",hideAvatar:"=hideavatar",imgName:"=name",hideName:"=hidename",ratingStar:"=ratingstar",imgDate:"=date",imgdateFormat:"=format",hideDate:"=hidedate",imgTitle:"=title",hideTitle:"=hidetitle",imgContent:"=content",hideLightbox:"=hide"},restrict:"C",link:function(b,c,d){b.$watch("gallery",function(){b.loading=!0,b.mainImg=b.imgDefault,b.images=b.gallery,b.active=b.currentIndex=b.gallery.indexOf(b.mainImg),b.next=function(){b.currentIndex<b.images.length-1?b.currentIndex++:b.currentIndex=0,b.gallery.indexOf(b.images[b.currentIndex])!==b.active&&(b.loading=!0),b.active=b.currentIndex,b.mainImg=b.images[b.currentIndex]},b.prev=function(){b.currentIndex>0?b.currentIndex--:b.currentIndex=b.images.length-1,b.gallery.indexOf(b.images[b.currentIndex])!==b.active&&(b.loading=!0),b.active=b.currentIndex,b.mainImg=b.images[b.currentIndex]}}),b.ryviuHideImgs=function(){b.hideLightbox()},b.send=function(c,d,e){b.$apply(function(){b.loading=c,d>=a.innerWidth-100&&(b.width=a.innerWidth-100+"px",b.height="auto"),e>a.innerHeight-150&&(b.width="auto",b.height=a.innerHeight-150+"px")})},b.ryviuChangeImg=function(a){b.gallery.indexOf(a)!==b.active&&(b.loading=!0,b.mainImg=a,b.active=b.currentIndex=b.gallery.indexOf(a))}}}},loaded:function(){return{restrict:"C",scope:{send:"=load"},link:function(a,b,c){b.bind("load",function(){a.send(!1,b[0].naturalWidth,b[0].naturalHeight)})}}},formWriteReview:function(a){return{restrict:"C",templateUrl:ryviu.app_init.html_file.form_review,link:function(a,b,c){a.user_info;void 0===a.request.rating&&(a.request.rating=5),a.$watch("user_info",function(b){var c;c="facebook.com"==b.providerId?"http://graph.facebook.com/"+b.uid+"/picture":b.photoURL,a.request=b?{cemail:b.email,cname:b.displayName,avatar:c,img_urls:a.img_urls,rating:5}:{img_urls:a.img_urls}}),a.review_vote=function(b){a.request.rating=parseInt(b)},a.ryviuSubmitForm=function(b,c){var d=[];if(a.form_error={cname:!1,cemail:!1,ctitle:!1,ccontent:!1},(void 0===a.request.cname&&!c.nolastname||""===a.request.cname&&!c.nolastname)&&(d.push("Your name is required field."),a.form_error.cname=!0),void 0!==a.request.cemail&&""!==a.request.cemail||(d.push("Your email is required and valid email."),a.form_error.cemail=!0),(void 0===a.request.ctitle&&c.title||""===a.request.ctitle&&c.title)&&(d.push("Title is required field."),a.form_error.ctitle=!0),void 0!==a.request.ccontent&&""!==a.request.ccontent||(d.push("Your review is required field."),a.form_error.ccontent=!0),(a.client_settings.RSA.enableVerifyEmail&&!a.is_user_logged_in||a.client_settings.RSA.enableSocialAuth&&!a.is_user_logged_in)&&(d.push("Please verify email or login with social."),a.social_login_error=!0,a.social_login_message="Please verify email or login with social"),d.length>0){var e="";angular.forEach(d,function(a,b){e=e+a+"\n"}),console.log(e)}else{var f=ryviu.tools.getDateNow();a.request=ryviu.rv_merge_objs(a.request,{date:f}),a.sendReview(a.request)}}}}},form_send_question:function(a){return{templateUrl:ryviu.app_init.html_file.question_form,restrict:"C",link:function(b,c,d){b.qa_message_status=!1,b.qa_avatar="";var e=b.user_info;e&&(b.qa_name=e.displayName,b.qa_email=e.email,b.qa_avatar=e.photoURL,"facebook.com"==e.providerId&&(b.qa_avatar="http://graph.facebook.com/"+e.uid+"/picture")),b.send_question=function(){var c=[];void 0!==b.qa_name&&""!==b.qa_name||c.push("name"),void 0!==b.qa_email&&ryviu.tools.validateEmail(b.qa_email)||c.push("email"),void 0!==b.qa_content&&""!==b.qa_content||c.push("content"),c.length>0?(b.qa_message_status=!0,b.qa_message="Please fill all fields before submit your question."):(b.qa_message_status=!1,b.qa_message="",b.loader={show:!0,loading:!0,message:""},a({url:ryviu.ajaxUrl,method:"POST",data:{shop_url:ryviu.shop_domain,search:b.qa_content,handle:b.current_product_handle,author:b.qa_name,author_email:b.qa_email,author_avatar:b.qa_avatar,protocol:ryviu.protocol},params:{action:"customer_send_question"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){b.qa_question_search="",b.loader={show:!0,loading:!1,message:"Your question sent!"},b.qa_name="",b.qa_email="",b.qa_content="",b.load_questions_answers()},function(a){console.log(a)}))}}}},form_answers_question:function(a){return{templateUrl:ryviu.app_init.html_file.answers_form,restrict:"C",link:function(b,c,d){b.answer_message_status=!1,b.answer_avatar="";var e=b.user_info;e&&(b.answer_name=e.displayName,b.answer_email=e.email,b.answer_avatar=e.photoURL,"facebook.com"==e.providerId&&(b.answer_avatar="http://graph.facebook.com/"+e.uid+"/picture")),b.send_answers=function(c){var d=c.ID,e={name:b.answer_name,email:b.answer_email,answer:b.answer_content,avatar:b.answer_avatar},f=[];void 0!==b.answer_name&&""!==b.answer_name||f.push("name"),void 0!==b.answer_email&&ryviu.tools.validateEmail(b.answer_email)||f.push("email"),void 0!==b.answer_content&&""!==b.answer_content||f.push("content"),f.length>0?(b.answer_message_status=!0,b.answer_message="Please fill all fields before submit your answer."):(b.answer_message_status=!1,b.answer_message="",b.loader={show:!0,loading:!0,message:""},a({url:ryviu.ajaxUrl,method:"POST",data:{shop_url:ryviu.shop_domain,handle:b.current_product_handle,qID:d,author:e,protocol:ryviu.protocol},params:{action:"customer_send_answer"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){b.loader={show:!0,loading:!1,message:"Your answer sent!"},b.answer_name="",b.answer_email="",b.answer_content="",b.load_questions_answers()},function(a){console.log(a)}))}}}},show_slider_reviews:function(a,b){return{templateUrl:ryviu.app_init.html_file.slider_reviews,restrict:"C",link:function(b,c,d){var e=c.attr("product-handle");b.current_product_handle=e,b.load_slider_items=function(){a({url:ryviu.ajaxUrl,method:"POST",data:{shop_url:ryviu.shop_domain,handle:e,protocol:ryviu.protocol},params:{action:"load_slider_items"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){console.log(a)},function(a){console.log(a)})},b.load_slider_items()}}},show_questions_answers:function(a,b,c){return{templateUrl:ryviu.app_init.html_file.questions_answers,restrict:"C",link:function(d,e,f){var g=e.attr("product-handle");d.current_product_handle=g,d.qa_message=!1,d.questions_answers_list={},d.numberAnswers=2,d.questions_answers_list=[],d.question_sort="total_vote",d.qsort="-total_vote",d.qLimit=5,d.qCurrentPage=1,d.qStart=(d.qCurrentPage-1)*d.qLimit,d.qEnd=d.qStart+d.qLimit,d.load_first_questions_answers=function(){b(function(){d.refresh_questions_answers_data(ryviu.data)},1e3)},d.load_questions_answers=function(){a({url:ryviu.ajaxUrl,method:"POST",data:{shop_url:ryviu.shop_domain,handle:g,protocol:ryviu.protocol},params:{action:"customer_load_questions"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){d.refresh_questions_answers_data(a.data)},function(a){console.log(a)})},d.load_first_questions_answers(),d.refresh_questions_answers_data=function(a){var b;(b="object"==typeof a.data?a.data:a)&&(d.questions_answers_list=Object.keys(b.questions_answers_list).map(function(a){return b.questions_answers_list[a]}),d.totalQuestion=d.questions_answers_list.length,d.qEnd>d.totalQuestion&&(d.qEnd=d.totalQuestion),d.numbers_page_question=Math.ceil(d.totalQuestion/d.qLimit),void 0!==d.current_question&&angular.forEach(d.questions_answers_list,function(a,b){a.ID===d.current_question.ID&&(d.current_question=a)}))},d.send_question=function(){if(""===d.qa_question_search)d.qa_message=!0;else{var b=d.user_info;b?(d.q_name=b.displayName,d.q_email=b.email,d.q_avatar=b.photoURL,"facebook.com"==b.providerId&&(d.q_avatar="http://graph.facebook.com/"+b.uid+"/picture"),a({url:ryviu.ajaxUrl,method:"POST",data:{shop_url:ryviu.shop_domain,search:d.qa_question_search,handle:g,author:d.q_name,author_email:d.q_email,author_avatar:d.q_avatar,protocol:ryviu.protocol},params:{action:"customer_send_question"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){d.qa_question_search="",d.refresh_questions_answers_data(a)},function(a){console.log(a)})):d.open_login_form()}},d.search_answers=function(){d._question=d.qa_question_search,d.questions_answers_list_filter=c(d.questions_answers_list,{question:d._question},!1),d.totalQuestion=d.questions_answers_list_filter.length,d.qStart=0,d.qEnd=d.qStart+d.qLimit,d.qEnd>d.totalQuestion&&(d.qEnd=d.totalQuestion)},d.qa_vote=function(b,c){var e=b.ID;a({url:ryviu.ajaxUrl,method:"POST",data:{shop_url:ryviu.shop_domain,handle:g,qID:e,vote_type:c,protocol:ryviu.protocol,client_ip:d.ip},params:{action:"qa_vote"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){d.refresh_questions_answers_data(a)},function(a){console.log(a)})},d.answer_vote=function(b,c,e){var f=b.ID,h=c.key;a({url:ryviu.ajaxUrl,method:"POST",data:{shop_url:ryviu.shop_domain,handle:g,qID:f,aKey:h,vote_type:e,protocol:ryviu.protocol,client_ip:d.ip},params:{action:"answer_vote"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){d.refresh_questions_answers_data(a)},function(a){console.log(a)})},d.question_sort_by=function(a){d.qsort="-"+a},d.question_paging_action=function(a,b,c){d.qStart=(a-1)*b,d.qEnd=parseInt(d.qStart)+parseInt(b),d.qEnd>c&&(d.qEnd=c),jQuery("html,body").animate({scrollTop:jQuery("#ryviu-questions-answers").offset().top},"slow")}}}},global_paging:function(){function a(a,b,c){a.$watchCollection("[page,pageSize,total,disabled]",function(){l(a,c)})}function b(a,b){return'<ul data-ng-hide="Hide" data-ng-class="ulClass"> <li title="{{Item.title}}" data-ng-class="Item.liClass" data-ng-repeat="Item in List"> <a '+(b.pgHref?'data-ng-href="{{Item.pgHref}}" ':"href ")+'data-ng-class="Item.aClass" data-ng-click="Item.action()" data-ng-bind="Item.value"></a> </li></ul>'}function c(a,b){a.List=[],a.Hide=!1,a.page=parseInt(a.page)||1,a.total=parseInt(a.total)||0,a.adjacent=parseInt(a.adjacent)||2,a.pgHref=a.pgHref||"",a.dots=a.dots||"...",a.ulClass=a.ulClass||"pagination",a.activeClass=a.activeClass||"active",a.disabledClass=a.disabledClass||"disabled",a.textFirst=a.textFirst||"<<",a.textLast=a.textLast||">>",a.textNext=a.textNext||">",a.textPrev=a.textPrev||"<",a.textFirstClass=a.textFirstClass||"",a.textLastClass=a.textLastClass||"",a.textNextClass=a.textNextClass||"",a.textPrevClass=a.textPrevClass||"",a.textTitlePage=a.textTitlePage||"Page {page}",a.textTitleFirst=a.textTitleFirst||"First Page",a.textTitleLast=a.textTitleLast||"Last Page",a.textTitleNext=a.textTitleNext||"Next Page",a.textTitlePrev=a.textTitlePrev||"Previous Page",a.hideIfEmpty=d(a,b.hideIfEmpty),a.showPrevNext=d(a,b.showPrevNext),a.showFirstLast=d(a,b.showFirstLast),a.scrollTop=d(a,b.scrollTop),a.isDisabled=d(a,b.disabled)}function d(a,b){return!!angular.isDefined(b)&&!!a.$parent.$eval(b)}function e(a,b){a.page>b&&(a.page=b),a.page<=0&&(a.page=1),a.adjacent<=0&&(a.adjacent=2),b<=1&&(a.Hide=a.hideIfEmpty)}function f(a,b){a.page!==b&&(a.isDisabled||(a.page=b,a.pagingAction({page:a.page,pageSize:a.pageSize,total:a.total}),a.scrollTop&&scrollTo(0,0)))}function g(a,b,c){if(!(!a.showPrevNext&&!a.showFirstLast||b<1)){var d,e,g;if("prev"===c){d=a.page-1<=0;var h=a.page-1<=0?1:a.page-1;a.showFirstLast&&(e={value:a.textFirst,title:a.textTitleFirst,aClass:a.textFirstClass,page:1}),a.showPrevNext&&(g={value:a.textPrev,title:a.textTitlePrev,aClass:a.textPrevClass,page:h})}else{d=a.page+1>b;var i=a.page+1>=b?b:a.page+1;a.showPrevNext&&(e={value:a.textNext,title:a.textTitleNext,aClass:a.textNextClass,page:i}),a.showFirstLast&&(g={value:a.textLast,title:a.textTitleLast,aClass:a.textLastClass,page:b})}var j=function(b,c){return{title:b.title,aClass:b.aClass,value:b.aClass?"":b.value,liClass:c?a.disabledClass:"",pgHref:c?"":a.pgHref.replace(m,b.page),action:function(){c||f(a,b.page)}}};if(a.isDisabled&&(d=!0),e){var k=j(e,d);a.List.push(k)}if(g){var l=j(g,d);a.List.push(l)}}}function h(a,b,c){var d=0;for(d=a;d<=b;d++){var e=c.pgHref.replace(m,d),g=c.page===d?c.activeClass:"";c.isDisabled&&(e="",g=c.disabledClass),c.List.push({value:d,title:c.textTitlePage.replace(m,d),liClass:g,pgHref:e,action:function(){f(c,this.value)}})}}function i(a){a.List.push({value:a.dots,liClass:a.disabledClass})}function j(a,b){h(1,2,a),3!==b&&i(a)}function k(a,b,c){c!==a-2&&i(b),h(a-1,a,b)}function l(a,b){(!a.pageSize||a.pageSize<=0)&&(a.pageSize=1);var d=Math.ceil(a.total/a.pageSize);c(a,b),e(a,d);var f,i,l=2*a.adjacent+2;g(a,d,"prev"),d<=l+2?(f=1,h(f,d,a)):a.page-a.adjacent<=2?(f=1,i=1+l,h(f,i,a),k(d,a,i)):a.page<d-(a.adjacent+2)?(f=a.page-a.adjacent,i=a.page+a.adjacent,j(a,f),h(f,i,a),k(d,a,i)):(f=d-l,i=d,j(a,f),h(f,i,a)),g(a,d,"next")}var m=/\{page\}/g;return{restrict:"EA",link:a,template:b,scope:{page:"@",pageSize:"@",total:"@",disabled:"@",dots:"@",ulClass:"@",activeClass:"@",disabledClass:"@",adjacent:"@",pagingAction:"&",pgHref:"@",textFirst:"@",textLast:"@",textNext:"@",textPrev:"@",textFirstClass:"@",textLastClass:"@",textNextClass:"@",textPrevClass:"@",textTitlePage:"@",textTitleFirst:"@",textTitleLast:"@",textTitleNext:"@",textTitlePrev:"@"}}},formReplyReview:function(a,b){return{restrict:"C",templateUrl:ryviu.app_init.html_file.form_reply,link:function(c,d,e){var f,g=c.user_info;f="facebook.com"==g.providerId?"http://graph.facebook.com/"+g.uid+"/picture":g.photoURL,g&&(c.reply_request={reply_cname:g.displayName,reply_cemail:g.email,avatar:f});var h=!0;c.ebr_status=h,c.brless=!0,c.brfull=!0,c.expand_body_review=function(){h?(c.brless=!1,c.brfull=!1,h=!1):(c.brless=!0,c.brfull=!0,h=!0),c.ebr_status=h},c.ryviuSubmitReplyForm=function(d){var e=c.current_review_key,f=c.reply_request.reply_cname,g=c.reply_request.reply_cemail,h=c.reply_request.reply_ccontent,i="";void 0!==c.user_info.photoURL&&(i=c.user_info.photoURL),c.reply_data={name:f,email:g,message:h,avatar:i};var j=[];if((void 0===c.reply_data.name&&!d||""===c.reply_data.name&&!d)&&j.push("Your name is required field."),c.validateEmail(c.reply_data.email)||j.push("Your email is not valid."),void 0!==c.reply_data.message&&""!==c.reply_data.message||j.push("Your message is required field."),j.length>0){var k="";angular.forEach(j,function(a,b){k=k+a+"\n"}),alert(k)}else c.loader={show:!0,loading:!0,message:""},a({url:ryviu.ajaxUrl,method:"POST",data:{shop_url:ryviu.shop_domain,handle:c.product_handle,review_key:e,reply_data:c.reply_data,protocol:ryviu.protocol},params:{action:"customer_write_reply"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){c.loader={show:!0,loading:!1,message:"Your reply sent, Please wait for approval."},c.load_reviews(c.product_handle),b(function(){c.loader={show:!1,loading:!1,message:""},c.hideReplyForm()},5e3)},function(a){console.log(a)})}}}},showReviews:function(a){return ryviu.disable_product_reviews?{}:{templateUrl:ryviu.app_init.html_file.template,restrict:"C",link:function(a,b,c){a.resizeFunction(),b.attr("class","ryviu-reviews-list");var d=b.attr("product-handle");a.send_product_handle=d,a.first_load_reviews(d)}}},showNumber:function(){return{restrict:"C",template:"{{total}}",link:function(a,b,c){"google"===ryviu.brain.mc_server()&&a.$watch("send_product_handle",function(a,b,c){if(void 0!==a){ryviu.firebase.database().ref("ryviu_reviews_data").child(ryviu.user_id+"/"+a+"/reviews_info").once("value").then(function(a){var b=a.val();"undefined"==typeof rv_text&&(reviewsText="Reviews"),c.loadRyviu=!0,c.total=null!==b?b.total_review:0})}})}}},pageAllReviews:function(a){return{restrict:"E",templateUrl:ryviu.app_init.html_file.list_all_reviews,link:function(b,c,d){ryviu.masonry.init(),b.paged_load=1,b.feature_reviews_list={},b.endpage=!1,b.loading=!0,b.load_feature_reviews=function(){a({url:ryviu.ajaxUrl,method:"POST",data:{shop_url:ryviu.shop_domain,protocol:ryviu.protocol,page:b.paged_load},params:{action:"load_feature_reviews"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){if(a.data){b.frSettings=a.data.fr_settings,b.total_reviews=a.data.total_reviews;var c=document.createElement("style");c.type="text/css",c.innerHTML="ryviu-show-all-reviews #content-ryviu{font-size: "+b.frSettings.font_size+"px;}.ryviu-fr-header>.stars>svg,ryviu-show-all-reviews .ryviu-stars-item svg{ fill: "+b.frSettings.star_color+"; }.ryviu-fr-header>.text_color{color: "+b.frSettings.text_color+" ;}",document.getElementsByTagName("head")[0].appendChild(c),""===b.frSettings.load_more_text?b.load_more_text="Load More":b.load_more_text=b.frSettings.load_more_text,ryviu.isEmpty(b.feature_reviews_list)?b.feature_reviews_list=a.data.reviews_data:angular.forEach(a.data.reviews_data,function(a){b.feature_reviews_list.push(a)}),b.paged_load++,b.endpage=a.data.endpage,b.reinit_masonry()}b.loading=!1},function(a){console.log(a)})},b.load_feature_reviews(),b.load_more_review=function(){b.loading=!0,b.load_feature_reviews()}}}},ryviuWidget:function(){return ryviu.disable_product_reviews?{}:{restrict:"C",replace:!0,priority:500,templateUrl:ryviu.app_init.html_file.product_widget,link:function(a,b,c){"google"===ryviu.brain.mc_server()&&a.$watch("send_product_handle",function(a,b,c){if(void 0!==a){ryviu.firebase.database().ref("ryviu_reviews_data").child(ryviu.user_id+"/"+a+"/reviews_info").once("value").then(function(a){var b=a.val(),d=ryviu.client_options.reviewsText;"undefined"==typeof rv_text&&(d="Reviews"),c.loadRyviu=!0,null!==b?(c.total=b.total_review,c.ratting={avg:Math.round(b.total_rating/b.total_review*100)/100,stars:b.stars}):(c.total=0,c.ratting={avg:0,stars:{s1:0,s2:0,s3:0,s4:0,s5:0}}),c.totalText="("+c.total+" "+d+")",c.$apply()})}})}}},collectionWidget:function(){return{restrict:"C",scope:{productHandle:"@",reviewsData:"=data"},templateUrl:ryviu.app_init.html_file.collection_widget,link:function(a,b,c){if("google"===ryviu.brain.mc_server()){ryviu.firebase.database().ref("ryviu_reviews_data").child(ryviu.user_id+"/"+a.productHandle+"/reviews_info").once("value").then(function(c){var d=c.val();a.avg=0,a.total=0,a.totalText="","object"==typeof d&&null!==d&&(a.avg=d.total_rating/d.total_review*20,a.total=d.total_review,a.totalText="("+a.total+")",a.$apply()),angular.element(b).addClass("ryviu-collection-loaded")}),a.settings=ryviu.client_options,a.settings.starcolor||(a.settings.starcolor="#ececec"),a.settings.starActivecolor||(a.settings.starActivecolor="#fdbc00")}else"ryviu"===ryviu.brain.mc_server()&&a.$watch("reviewsData",function(){if(void 0!==a.reviewsData){if(a.settings=ryviu.data.client_settings,void 0===a.settings&&(a.settings=ryviu_user_settings),a.settings.starcolor||(a.settings.starcolor="#ececec"),a.settings.starActivecolor||(a.settings.starActivecolor="#fdbc00"),a.avg=0,a.total=0,a.totalText="",a.reviewsData.data&&void 0!==a.reviewsData.data[a.productHandle]){var c=a.reviewsData.data[a.productHandle].split(",");a.avg=c[1]/c[0]*20,a.total=c[0],a.totalText="("+a.total+")"}angular.element(b).addClass("ryviu-collection-loaded")}})}}},moreLessText:function(a){return{restrict:"C",scope:{text:"=bodyText"},template:'<span limit="{{limit_ran}}">{{body_text}}</span> <a href="javascript:void(0)" ng-click="more_less_text()" ng-if="show_more">[...]</a>',link:function(b,c,d){b.open=!1,b.limit_ran=ryviu.tools.randIn(220,320),b.$watch("text",function(){var a=b.text;a.length>b.limit_ran?(b.show_more=!0,b.body_text=a.substring(0,b.limit_ran)):b.body_text=a}),b.more_less_text=function(){b.open=!b.open,!0===b.open?b.body_text=b.text:b.body_text=b.text.substring(0,b.limit_ran),a(function(){angular.element(ryviu.masonry.selector).masonry(ryviu.masonry.option).masonry("reloadItems"),ryviu.masonry.current_time_scan=0})}}}},fileread:function(){return{scope:{fileread:"="},link:function(a,b,c){b.bind("change",function(b){if(b.target.files.length>0){var c=new FileReader;c.onload=function(b){a.$apply(function(){a.fileread(b.target.result)})},c.readAsDataURL(b.target.files[0])}})}}},scroll:function(b,c,d){return function(e,f,g){function h(){if(!0===e.user_watching.in_view&&0===ryviu.app_init.disable_tracking){var a;a=e.product_handle,d({url:ryviu.ajaxUrl,method:"POST",data:{shop_url:ryviu.shop_url,handle:a,tracking:{uw:e.user_watching,vi:e.viewer_info},protocol:ryviu.protocol},params:{action:"ryviu_tracking_view"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){},function(a){console.log(a)})}}e.user_watching={in_view:!1,progress_view:0,viewed:0},angular.element(b).bind("scroll",function(){var a,c,d,f,g,h,i=e.f("#content-ryviu")[0];if(null!==i&&void 0!==i){a=i.offsetTop,c=i.offsetHeight,d=a+c,f=b.innerHeight/2;var j=a-f+35;this.pageYOffset>=j&&this.pageYOffset<d?(e.user_watching.in_view=!0,h=this.pageYOffset,g=h/c*100-j/c*100,g<0&&(g=0),g>100&&(g=100)):e.user_watching.in_view=!1,e.user_watching.progress_view=g,e.user_watching.viewed<g&&(e.user_watching.viewed=g)}e.$apply()}),e.viewer_info={timeOpened:new Date,pageon:a.location.pathname,referrer:document.referrer,previousSites:history.length,browserName:navigator.appName,browserEngine:navigator.product,browserVersion:navigator.userAgent,browserPlatform:navigator.platform};var i;e.tracking_start=function(){e.tracking_stop(),i=c(h,1e4)},e.tracking_stop=function(){c.cancel(i)},e.tracking_start(),e.$on("$destroy",function(){e.tracking_stop()})}},scroll_to:function(){return{restrict:"A",scope:{scrollTo:"@"},link:function(a,b,c){b.on("click",function(){console.log(1),jQuery("html,body").animate({scrollTop:jQuery(a.scrollTo).offset().top},"slow")})}}},owlCarousel:function(){return{restrict:"E",transclude:!1,link:function(a){a.initCarousel=function(b){var c={margin:10},d=a.$eval($(b).attr("data-options"));for(var e in d)c[e]=d[e];$(b).owlCarousel(c)},a.$watch(a.product_reviews_list,function(){console.log(1)})}}},owlCarouselItem:function(){return{restrict:"A",transclude:!1,link:function(a,b){a.$last&&a.initCarousel(b.parent())}}}},filter:{filter_star:function(){return function(a,b){var c="",d=[];return void 0!==a&&(c=a,"*"!==b&&(angular.forEach(c,function(a,c){a.rating===b&&d.push(a)}),c=d)),c}},author_name:function(){return function(a){if(a){var b=a.trim();return a.indexOf(" ")>=0&&(b=b.slice(0,1)+". "+b.substr(b.indexOf(" ")+1)),b}}},start:function(){return function(a,b){var c="";return void 0!==a&&(c=a.slice(b)),c}},timeago:function(){return function(a,b){var c,d=function(a,b,c){var d=angular.isFunction(a)?a(b,k):a,e=c.numbers&&c.numbers[b]||b;return d.replace(/%d/i,e)},e=(new Date).getTime(),f=new Date(a).getTime(),g=b||!1,h=ryviu.client_options.about_text?ryviu.client_options.about_text:"about",i=ryviu.client_options.hours_text?ryviu.client_options.hours_text:"hours",j={prefixAgo:"",prefixFromNow:"",suffixAgo:ryviu.client_options.ago_text?ryviu.client_options.ago_text:"ago",suffixFromNow:ryviu.client_options.from_now_text?ryviu.client_options.from_now_text:"from now",seconds:ryviu.client_options.less_than_text?ryviu.client_options.less_than_text:"less than a minute",minute:ryviu.client_options.about_a_minute_text?ryviu.client_options.about_a_minute_text:"about a minute",minutes:ryviu.client_options.minutes_text?"%d "+ryviu.client_options.minutes_text:"%d minutes",hour:ryviu.client_options.about_an_hour_text?ryviu.client_options.about_an_hour_text:"about an hour",hours:h+" %d "+i,day:ryviu.client_options.a_day_text?ryviu.client_options.a_day_text:"a day",days:ryviu.client_options.days_text?"%d "+ryviu.client_options.days_text:"%d days",month:ryviu.client_options.about_a_month_text?ryviu.client_options.about_a_month_text:"about a month",months:ryviu.client_options.months_text?"%d "+ryviu.client_options.months_text:"%d months",year:ryviu.client_options.about_a_year_text?ryviu.client_options.about_a_year_text:"about a year",years:ryviu.client_options.years_text?"%d "+ryviu.client_options.years_text:"%d years"},k=e-f,l=Math.abs(k)/1e3,m=l/60,n=m/60,o=n/24,p=o/365,q=void 0===j.wordSeparator?" ":j.wordSeparator,r=j.prefixAgo,s=j.suffixAgo;return g&&k<0&&(r=j.prefixFromNow,s=j.suffixFromNow),c=l<45&&d(j.seconds,Math.round(l),j)||l<90&&d(j.minute,1,j)||m<45&&d(j.minutes,Math.round(m),j)||m<90&&d(j.hour,1,j)||n<24&&d(j.hours,Math.round(n),j)||n<42&&d(j.day,1,j)||o<30&&d(j.days,Math.round(o),j)||o<45&&d(j.month,1,j)||o<365&&d(j.months,Math.round(o/30),j)||p<1.5&&d(j.year,1,j)||d(j.years,Math.round(p),j),r.replace(/ /g,""),c.replace(/ /g,""),s.replace(/ /g,""),r+" "+c+" "+s+" "+q}},star_percent:function(){return function(a,b){return Math.round(a/b*100)}}},config:function(a,b,c,d){a.resourceUrlWhitelist(["self","https://app.ryviu.com/**","https://ryviu-app.firebaseapp.com/**"]),b.startSymbol("{[{").endSymbol("}]}"),delete c.defaults.headers.common["X-Requested-With"],d.setOptions({offset:100,errorClass:"error",successClass:"lazy-success",onError:function(a){console.log(a)},onSuccess:function(a){angular.element(ryviu.masonry.selector).masonry(ryviu.masonry.option)}})}},extensions:{},core:function(){var a=document.getElementsByTagName("form");angular.forEach(a,function(a){!1===a.hasAttribute("action")&&a.setAttribute("action","")}),ryviu.app_init={disable_tracking:1,html_file:{list_all_reviews:ryviu.brain.theme_path()+"/all_reviews.html",template:ryviu.brain.theme_path()+"/main.html",lightbox:ryviu.brain.theme_path()+"/lightbox.html",collection_widget:ryviu.brain.theme_path()+"/collection_widget.html",product_widget:ryviu.brain.theme_path()+"/product_widget.html",form_review:ryviu.brain.theme_path()+"/form.html",form_reply:ryviu.brain.theme_path()+"/reply.html",questions_answers:ryviu.brain.theme_path()+"/questions_answers.html",question_form:ryviu.brain.theme_path()+"/question_form.html",answers_form:ryviu.brain.theme_path()+"/answers_form.html",slider_reviews:ryviu.brain.theme_path()+"/slider_reviews.html"},security_code:null!==ryviu.sec_code?ryviu.sec_code:""},ryviu._php_server_url=ryviu.brain.php_server_url(),ryviu._client_server_url=ryviu.brain.server_url(),ryviu.brain.main.$inject=["$rootScope","$scope","$http","$sce","filterFilter","$compile","$timeout","$interval","$firebaseObject","$firebaseArray","$element","$document"],ryviu.brain.directive.lightbox.$inject=["$window"],ryviu.brain.directive.loaded.$inject=[],ryviu.brain.directive.masonryFirstImage.$inject=[],ryviu.brain.directive.formWriteReview.$inject=["$timeout"],ryviu.brain.directive.formReplyReview.$inject=["$http","$timeout"],ryviu.brain.directive.pageAllReviews.$inject=["$http"],ryviu.brain.directive.form_send_question.$inject=["$http"],ryviu.brain.directive.form_answers_question.$inject=["$http"],ryviu.brain.directive.show_questions_answers.$inject=["$http","$timeout","filterFilter"],ryviu.brain.directive.show_slider_reviews.$inject=["$http","filterFilter"],ryviu.brain.directive.showReviews.$inject=["$timeout"],ryviu.brain.directive.showNumber.$inject=[],ryviu.brain.directive.moreLessText.$inject=["$timeout"],ryviu.brain.directive.ryviuWidget.$inject=[],ryviu.brain.directive.collectionWidget.$inject=[],ryviu.brain.filter.filter_star.$inject=[],ryviu.brain.filter.start.$inject=[],ryviu.brain.filter.author_name.$inject=[],ryviu.brain.filter.star_percent.$inject=[],ryviu.brain.directive.fileread.$inject=[],ryviu.brain.directive.scroll.$inject=["$window","$interval","$http"],ryviu.brain.config.$inject=["$sceDelegateProvider","$interpolateProvider","$httpProvider","lazyImgConfigProvider"],angular.module("ryviuClientReviews",["ngAnimate","firebase","angularLazyImg"]).controller("ryviuMainCtrl",ryviu.brain.main).directive("ryviuLightbox",ryviu.brain.directive.lightbox).directive("firstImg",ryviu.brain.directive.masonryFirstImage).directive("ryviuLoaded",ryviu.brain.directive.loaded).directive("formWriteReview",ryviu.brain.directive.formWriteReview).directive("ryviuShowReviews",ryviu.brain.directive.showReviews).directive("ryviuShowNumber",ryviu.brain.directive.showNumber).directive("ryviuQuestionsAnswers",ryviu.brain.directive.show_questions_answers).directive("paging",ryviu.brain.directive.global_paging).directive("ryviuSliderReviews",ryviu.brain.directive.show_slider_reviews).directive("formSendQuestion",ryviu.brain.directive.form_send_question).directive("formAnswersQuestion",ryviu.brain.directive.form_answers_question).directive("ryviuWidget",ryviu.brain.directive.ryviuWidget).directive("formReplyReview",ryviu.brain.directive.formReplyReview).directive("ryviuShowAllReviews",ryviu.brain.directive.pageAllReviews).directive("moreLessText",ryviu.brain.directive.moreLessText).directive("fileread",ryviu.brain.directive.fileread).directive("rvScroll",ryviu.brain.directive.scroll).directive("ryviuCollectionWidget",ryviu.brain.directive.collectionWidget).directive("scrollToItem",ryviu.brain.directive.scroll_to).directive("owlCarousel",ryviu.brain.directive.owlCarousel).directive("owlCarouselItem",ryviu.brain.directive.owlCarouselItem).filter("filter_star",ryviu.brain.filter.filter_star).filter("start",ryviu.brain.filter.start).filter("author_name",ryviu.brain.filter.author_name).filter("star_percent",ryviu.brain.filter.star_percent).filter("timeago",ryviu.brain.filter.timeago).config(ryviu.brain.config),angular.bootstrap(document,["ryviuClientReviews"])},time_exit_run:3e3,current_time_run:0,run:function(){setTimeout(function(){var a=Object.keys(ryviu.libs_need_load).map(function(a){return ryviu.libs_need_load[a]});if(ryviu.current_time_run+=10,ryviu.current_time_run>ryviu.time_exit_run){var b=new XMLHttpRequest;b.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var a=JSON.parse(this.responseText);ryviu.client_options=a.options,ryviu.core()}},b.open("POST",ryviu.ajaxUrl+"?action=get_client_settings&shop_url="+ryviu.tools.base64.encode(ryviu.shop_url),!0),b.send()}else ryviu.libs_loaded.length>0&&a.length===ryviu.libs_loaded.length&&void 0!==ryviu.client_options.starStyle?ryviu.core():ryviu.run()},10)}},ryviu.tools.base64.stringBuffer.prototype.append=function(a){return this.buffer.push(a),this},ryviu.tools.base64.stringBuffer.prototype.toString=function(){return this.buffer.join("")},ryviu.tools.base64.utf8EncodeEnumerator.prototype={current:Number.NaN,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=Number.NaN,!1;var a=this._input.charCodeAt(++this._index);return 13===a&&10===this._input.charCodeAt(this._index+1)&&(a=10,this._index+=2),a<128?this.current=a:a>127&&a<2048?(this.current=a>>6|192,this._buffer.push(63&a|128)):(this.current=a>>12|224,this._buffer.push(a>>6&63|128),this._buffer.push(63&a|128)),!0}},ryviu.tools.base64.decodeEnumerator.prototype={current:64,moveNext:function(){if(this._buffer.length>0)return this.current=this._buffer.shift(),!0;if(this._index>=this._input.length-1)return this.current=64,!1;var a=ryviu.tools.base64.codex.indexOf(this._input.charAt(++this._index)),b=ryviu.tools.base64.codex.indexOf(this._input.charAt(++this._index)),c=ryviu.tools.base64.codex.indexOf(this._input.charAt(++this._index)),d=ryviu.tools.base64.codex.indexOf(this._input.charAt(++this._index)),e=a<<2|b>>4,f=(15&b)<<4|c>>2,g=(3&c)<<6|d;return this.current=e,64!==c&&this._buffer.push(f),64!==d&&this._buffer.push(g),!0}},document.addEventListener("DOMContentLoaded",function(a){ryviu.init()}),"undefined"!=typeof InstantClick){var b=ryviu.tools._href();InstantClick.on("change",function(){var c=ryviu.tools._href();b!=c&&ryviu.is_init()&&a.location.reload()})}"undefined"!=typeof BCSfFilter&&"function"!=typeof BCSfFilter.prototype.buildExtrasProductList&&(BCSfFilter.prototype.buildExtrasProductList=function(a){ryviu.callback.loadCollectionsData(function(){},a)})}(window);